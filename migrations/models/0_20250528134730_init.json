{
  "upgrade": [
    "CREATE TABLE IF NOT EXISTS \"applications\" (\n    \"id\" VARCHAR(100) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL UNIQUE,\n    \"description\" TEXT,\n    \"is_active\" BOOL NOT NULL DEFAULT True\n);\nCREATE TABLE IF NOT EXISTS \"companies\" (\n    \"id\" UUID NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL,\n    \"description\" TEXT\n);\nCREATE TABLE IF NOT EXISTS \"permissions\" (\n    \"id\" VARCHAR(255) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL,\n    \"comment\" VARCHAR(255)\n);\nCREATE TABLE IF NOT EXISTS \"restrictions\" (\n    \"id\" VARCHAR(255) NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(255) NOT NULL,\n    \"comment\" VARCHAR(255)\n);\nCREATE TABLE IF NOT EXISTS \"user_roles\" (\n    \"id\" UUID NOT NULL PRIMARY KEY,\n    \"name\" VARCHAR(50) NOT NULL UNIQUE,\n    \"system_name\" VARCHAR(50) UNIQUE,\n    \"comment\" TEXT,\n    \"application_id\" VARCHAR(100) NOT NULL REFERENCES \"applications\" (\"id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"role_permission_relations\" (\n    \"id\" UUID NOT NULL PRIMARY KEY,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"permission_id\" VARCHAR(255) NOT NULL REFERENCES \"permissions\" (\"id\") ON DELETE CASCADE,\n    \"restriction_id\" VARCHAR(255) REFERENCES \"restrictions\" (\"id\") ON DELETE SET NULL,\n    \"role_id\" UUID NOT NULL REFERENCES \"user_roles\" (\"id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"users\" (\n    \"id\" UUID NOT NULL PRIMARY KEY,\n    \"email\" VARCHAR(255) NOT NULL UNIQUE,\n    \"password_hash\" VARCHAR(255) NOT NULL,\n    \"full_name\" VARCHAR(255) NOT NULL,\n    \"position\" VARCHAR(255),\n    \"is_superadmin\" BOOL NOT NULL DEFAULT False,\n    \"is_verified\" BOOL NOT NULL DEFAULT False\n);\nCREATE TABLE IF NOT EXISTS \"api_tokens\" (\n    \"id\" UUID NOT NULL PRIMARY KEY,\n    \"token_hash\" VARCHAR(255) NOT NULL,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"expires_at\" TIMESTAMPTZ,\n    \"comment\" TEXT,\n    \"application_id\" VARCHAR(100) NOT NULL REFERENCES \"applications\" (\"id\") ON DELETE CASCADE,\n    \"user_id\" UUID NOT NULL REFERENCES \"users\" (\"id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"user_to_company_relations\" (\n    \"id\" UUID NOT NULL PRIMARY KEY,\n    \"created_at\" TIMESTAMPTZ NOT NULL DEFAULT CURRENT_TIMESTAMP,\n    \"company_id\" UUID NOT NULL REFERENCES \"companies\" (\"id\") ON DELETE CASCADE,\n    \"role_id\" UUID NOT NULL REFERENCES \"user_roles\" (\"id\") ON DELETE CASCADE,\n    \"user_id\" UUID NOT NULL REFERENCES \"users\" (\"id\") ON DELETE CASCADE\n);\nCREATE TABLE IF NOT EXISTS \"aerich\" (\n    \"id\" SERIAL NOT NULL PRIMARY KEY,\n    \"version\" VARCHAR(255) NOT NULL,\n    \"app\" VARCHAR(20) NOT NULL\n);"
  ]
}